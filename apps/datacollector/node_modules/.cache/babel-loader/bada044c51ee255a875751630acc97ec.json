{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"C:\\\\webWork\\\\htdocs\\\\angryPXL\\\\apps\\\\datacollector\\\\src\\\\logic\\\\jsonbuilder.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport './jsonbuilder.css';\nimport './syntaxhighlight';\nimport { _zcmStart, _evilcook } from './cat'; // icons\n\nimport editIcon from \"./builder/edit.svg\";\nimport sortIcon from \"./builder/sort.svg\";\nimport downloadIcon from \"./builder/download.svg\";\nimport compileIcon from \"./builder/compile.svg\";\nimport crossIcon from \"./builder/circlecross.svg\";\nexport const builderHook = {};\nconst prepArray = [];\nconst prepObj = [];\nvar path = [];\n\nconst handleChange = (event, obj) => {\n  console.log(event.target.dataset.zcm);\n  console.log(obj);\n  obj[event.target.dataset.zcm] = event.target.innerText;\n  let parent = findRealParent(event.target, 'zkey');\n  parent.dataset.zkey = event.target.innerText;\n};\n\nconst setEdit = e => {\n  e.stopPropagation(); // if ( activeTool === 'edit' ) {\n\n  e.target.setAttribute('contenteditable', ''); // } else if ( activeTool === 'sort' ) {\n  // \te.target.draggable = true;\n  // \tconsole.log(e.target)\n  // } else if ( activeTool === 'json' ) {\n  // } else if ( activeTool === 'compile' ) {\n  // }\n};\n\nconst unsetEdit = e => {\n  e.target.removeAttribute('contenteditable');\n};\n\nvar viewport = {\n  height: window.innerHeight,\n  width: window.innerWidth\n};\nvar resizeStartValues = {\n  x: 0,\n  y: 0\n};\nvar startPos = {\n  x: 0,\n  y: 0\n};\nvar dragOffset = {\n  x: 0,\n  y: 0\n};\nvar hitBox = {\n  top: {\n    val: 0,\n    drop: 0,\n    hit: false\n  },\n  right: {\n    val: 0,\n    drop: 0,\n    hit: false\n  },\n  bottom: {\n    val: 0,\n    drop: 0,\n    hit: false\n  },\n  left: {\n    val: 0,\n    drop: 0,\n    hit: false\n  }\n};\n\nconst findRealParent = (el, set, name = 'any') => {\n  let realParent = el;\n\n  if (name === 'any') {\n    while (!realParent.dataset[set]) {\n      realParent = realParent.parentElement;\n    }\n  } else if (name !== 'any') {\n    while (realParent.dataset[set] !== name) {\n      realParent = realParent.parentElement;\n    }\n  }\n\n  return realParent;\n};\n\nconst generateRandomString = () => {\n  return Math.random().toString(36).substring(2, 15); // + Math.random().toString(36).substring(2, 15)\n};\n\nconst builderDims = {\n  height: 0,\n  width: 0\n};\nlet logTick = true;\n\nconst logTimer = () => {\n  logTick = false;\n  setTimeout(() => {\n    logTick = true;\n  }, 200);\n}; // init copycat\n\n\n_zcmStart();\n\nlet rawjson = '';\nlet rawComponents = [];\nvar mouseMove, mouseUp, resizeMove, resizeEnd;\n\nconst JSONBuilder = () => {\n  _s();\n\n  var _path, _path2, _path3;\n\n  const [toggleMinimizeState, setToggleMinimize] = useState('open');\n  const [list, setList] = useState(null);\n  const [activeTool, setTool] = useState('edit');\n  let dragging = false;\n  let dragY = 0;\n  let dragged;\n  let heroIndex, targetIndex;\n\n  function startDrag(e) {\n    dragY = e.screenY;\n    dragged = e.target;\n    dragged.style.pointerEvents = 'none';\n    dragged.style.zIndex = '10';\n    let parent = e.target.parentElement;\n    parent.style.userSelect = 'none';\n    let siblings = parent.children;\n    Object.values(siblings).forEach(s => {\n      s.addEventListener('mousemove', dragEntry);\n    });\n    prepObj.forEach((c, i) => {\n      if (c.id === e.target.dataset.zid) {\n        heroIndex = i;\n        return;\n      }\n    });\n    window.addEventListener('mouseup', dropEntry);\n  }\n\n  let dragEntryOffset;\n\n  function dragEntry(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    dragging = true;\n\n    if (dragged) {\n      dragEntryOffset = e.screenY - dragY;\n      dragged.style.transform = `translate3d(0,${dragEntryOffset}px,0)`;\n    }\n\n    prepObj.forEach((c, i) => {\n      if (c.id === e.target.dataset.zid) {\n        targetIndex = i; // console.log(c.id)\n\n        return;\n      }\n    });\n  }\n\n  function dropEntry(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    dragged && dragged.removeAttribute('style');\n    dragEntryOffset = 0;\n    dragged = null;\n    let parent = e.target.parentElement;\n\n    if (parent) {\n      let siblings = parent.children;\n      parent.style.userSelect = '';\n\n      if (targetIndex >= 0 && dragging === true) {\n        let hero = prepObj[heroIndex];\n        let uiHero = prepArray[heroIndex];\n        prepObj.splice(heroIndex, 1);\n        prepObj.splice(targetIndex, 0, hero);\n        prepArray.splice(heroIndex, 1);\n        prepArray.splice(targetIndex, 0, uiHero);\n        setList(e.timeStamp);\n      }\n\n      dragging = false;\n      window.removeEventListener('mouseup', dropEntry);\n      Object.values(siblings).forEach(s => {\n        s.removeEventListener('mousemove', dragEntry);\n      });\n    } // }\n\n  }\n\n  function handleMouseMove(e, el, container) {\n    e.stopPropagation();\n    e.preventDefault();\n    let screenPos = container.getBoundingClientRect();\n    hitBox.top.val = screenPos.top;\n    hitBox.right.val = screenPos.right;\n    hitBox.bottom.val = screenPos.bottom;\n    hitBox.left.val = screenPos.left; // hit detection top & bottom\n\n    if (hitBox.top.val >= 0 && !hitBox.top.hit && hitBox.bottom.val <= viewport.height && !hitBox.bottom.hit) {\n      dragOffset.y = e.screenY - startPos.y;\n    } else if (hitBox.top.val <= 0 && !hitBox.top.hit) {\n      !hitBox.bottom.hit && (hitBox.top.hit = true);\n      hitBox.top.drop = e.screenY;\n    } else if (e.screenY > hitBox.top.drop && hitBox.top.hit) {\n      hitBox.top.hit = false;\n      !hitBox.bottom.hit && (dragOffset.y += 1);\n    } else if (hitBox.bottom.val >= viewport.height && !hitBox.bottom.hit) {\n      !hitBox.top.hit && (hitBox.bottom.hit = true);\n      hitBox.bottom.drop = e.screenY;\n    } else if (e.screenY < hitBox.bottom.drop && hitBox.bottom.hit) {\n      hitBox.bottom.hit = false;\n      !hitBox.top.hit && (dragOffset.y -= 1);\n    } // hit detection left & right\n\n\n    if (hitBox.left.val >= 0 && !hitBox.left.hit && hitBox.right.val <= viewport.width && !hitBox.right.hit) {\n      dragOffset.x = e.screenX - startPos.x;\n    } else if (hitBox.left.val <= 0 && !hitBox.left.hit) {\n      !hitBox.right.hit && (hitBox.left.hit = true);\n      hitBox.left.drop = e.screenX;\n    } else if (e.screenX > hitBox.left.drop && hitBox.left.hit) {\n      hitBox.left.hit = false;\n      !hitBox.right.hit && (dragOffset.x += 1);\n    } else if (hitBox.right.val >= 0 && !hitBox.right.hit) {\n      !hitBox.left.hit && (hitBox.right.hit = true);\n      hitBox.right.drop = e.screenX;\n    } else if (e.screenX < hitBox.right.drop && hitBox.right.hit) {\n      hitBox.right.hit = false;\n      !hitBox.left.hit && (dragOffset.x -= 1);\n    } // logTick && console.log(`screeX:  ${e.screenX}\\n`, `dragOffsetX:  ${dragOffset.x}`);\n    // logTick && console.log(`hitRight:  ${hitBox.right.hit}\\n`, `hitLeft:  ${hitBox.left.hit}`);\n    // logTick && console.log(`leftDrop:  ${hitBox.left.drop}\\n`, `leftVal:  ${hitBox.left.val}`);\n    // logTick && console.log(`rightDrop:  ${hitBox.right.drop}\\n`, `rightVal:  ${hitBox.right.val}`, `vpHeight:  ${viewport.width}`);\n    //____________________________________________________________________________________________________________\n    // logTick && console.log(`screeY:  ${e.screenY}\\n`, `dragOffsetY:  ${dragOffset.y}`);\n    // logTick && console.log(`hitBottom:  ${hitBox.bottom.hit}\\n`, `hitTop:  ${hitBox.top.hit}`);\n    // logTick && console.log(`topDrop:  ${hitBox.top.drop}\\n`, `topVal:  ${hitBox.top.val}`);\n    // logTick && console.log(`bottomDrop:  ${hitBox.bottom.drop}\\n`, `bottomVal:  ${hitBox.bottom.val}`, `vpHeight:  ${viewport.height}`);\n    // logTick && console.log(e.screenX, hitBox.right.drop, dragOffset.x, hitBox.right.val, viewport.width, hitBox.right.hit);\n\n\n    container.style.transform = `translate3d( ${dragOffset.x}px, ${dragOffset.y}px,0 )`;\n    logTick && logTimer();\n  }\n\n  function handleMouseUp(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    window.removeEventListener('mousemove', mouseMove);\n    window.removeEventListener('mouseup', mouseUp);\n    hitBox.top.drop = 0;\n    hitBox.right.drop = viewport.width;\n    hitBox.bottom.drop = viewport.height;\n    hitBox.left.drop = 0;\n  }\n\n  function handleMouseDown(e) {\n    let container = findRealParent(e.target, 'zmain', 'builderContainer');\n    e.stopPropagation();\n    e.preventDefault();\n\n    mouseMove = event => handleMouseMove(event, e, container);\n\n    mouseUp = event => handleMouseUp(event, e);\n\n    window.addEventListener('mousemove', mouseMove);\n    window.addEventListener('mouseup', mouseUp);\n    startPos = {\n      x: e.screenX - dragOffset.x,\n      y: e.screenY - dragOffset.y\n    };\n  }\n\n  function handleResizeMove(e, el, container, handle, vals) {\n    if (handle === 'bottom') {\n      container.style.height = `${resizeStartValues.height + e.screenY - resizeStartValues.y}px`;\n    } else {\n      container.style.width = `${resizeStartValues.width + resizeStartValues.x - e.screenX}px`;\n    } // logTick && logTimer();\n\n  }\n\n  function handleResizeEnd(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    window.removeEventListener('mousemove', resizeMove);\n    window.removeEventListener('mouseup', resizeEnd);\n  }\n\n  function handleStartResize(e) {\n    let container = findRealParent(e.target, 'zmain', 'builderContainer');\n    let handle = e.target.dataset.rh;\n    let box = container.getBoundingClientRect();\n    resizeStartValues = {\n      x: e.screenX,\n      y: e.screenY,\n      height: box.height,\n      width: box.width,\n      left: box.left,\n      right: box.right\n    };\n    e.stopPropagation();\n    e.preventDefault();\n\n    resizeMove = event => handleResizeMove(event, e, container, handle);\n\n    resizeEnd = event => handleResizeEnd(event, e);\n\n    window.addEventListener('mousemove', resizeMove);\n    window.addEventListener('mouseup', resizeEnd);\n  }\n\n  function minimizeBuilder(e) {\n    let container = findRealParent(e.target, 'zmain', 'builderContainer');\n\n    if (toggleMinimizeState === 'open') {\n      builderDims.height = container.style.height;\n      builderDims.width = container.style.width;\n      container.style.height = '';\n      container.style.width = '';\n      hitBox.top.drop = 0;\n      hitBox.right.drop = viewport.width;\n      hitBox.bottom.drop = viewport.height;\n      hitBox.left.drop = 0;\n      hitBox.top.hit = false;\n      hitBox.right.hit = false;\n      hitBox.bottom.hit = false;\n      hitBox.left.hit = false;\n      setToggleMinimize('minimized');\n    } else {\n      container.style.height = builderDims.height;\n      container.style.width = builderDims.width;\n      setToggleMinimize('open');\n    }\n  }\n\n  useEffect(() => {\n    builderHook.dispatch = setList;\n\n    window.onclick = e => {\n      e.stopPropagation();\n      e.preventDefault();\n\n      if (e.target.dataset.zel !== 'builder' && !e.target.dataset.selected) {\n        let key = `key_${generateRandomString()}`;\n        let id = `id_${generateRandomString()}`;\n        e.target.setAttribute('data-selected', key);\n        let entry = {\n          id: id,\n          key: key,\n          type: 'pair',\n          value: e.target.innerHTML.replace(/<span[\\s\\S]*?\\b<\\/span>/g, ''),\n          path: JSON.parse(JSON.stringify(path))\n        };\n        prepObj.push(entry);\n        prepArray.push( /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `Data-Entry`,\n          \"data-zel\": \"builder\",\n          \"data-zid\": entry.id,\n          \"data-zkey\": entry.key,\n          onMouseDown: ev => startDrag(ev),\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: `Input-Field key`,\n            \"data-zcm\": 'key',\n            \"data-zel\": \"builder\",\n            onInput: ev => handleChange(ev, entry),\n            onMouseDown: ev => setEdit(ev, activeTool),\n            onBlur: ev => unsetEdit(ev),\n            children: entry.key\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `Colon`,\n            \"data-zel\": \"builder\",\n            children: \":\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 381,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            className: `Input-Field value`,\n            \"data-zcm\": 'value',\n            \"data-zel\": \"builder\",\n            onInput: ev => handleChange(ev, entry),\n            onMouseDown: ev => setEdit(ev, activeTool),\n            onBlur: ev => unsetEdit(ev),\n            children: entry.value\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 382,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            className: `Inline-Button`,\n            src: crossIcon,\n            alt: \"Delete entry\",\n            onMouseDown: deleteEntry,\n            \"data-zel\": \"builder\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 383,\n            columnNumber: 7\n          }, this)]\n        }, key, true, {\n          fileName: _jsxFileName,\n          lineNumber: 379,\n          columnNumber: 6\n        }, this));\n        setList(e.timeStamp);\n      }\n    };\n  }, []);\n\n  const handleNest = e => {\n    let key = `key_${generateRandomString()}`;\n    let id = `id_${generateRandomString()}`;\n    path.push({\n      type: 'nest',\n      key\n    });\n    let entry = {\n      id: id,\n      key: key,\n      type: 'nest',\n      value: {},\n      path: JSON.parse(JSON.stringify(path))\n    };\n    prepObj.push(entry);\n    prepArray.push( /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `Data-Entry`,\n      \"data-zel\": \"builder\",\n      \"data-zid\": entry.id,\n      \"data-zkey\": entry.key,\n      onMouseDown: ev => startDrag(ev),\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: `Input-Field key`,\n        \"data-zcm\": 'key',\n        \"data-zel\": \"builder\",\n        onInput: ev => handleChange(ev, entry),\n        onMouseDown: ev => setEdit(ev, activeTool),\n        onBlur: ev => unsetEdit(ev),\n        style: {\n          color: '#f751b1'\n        },\n        children: entry.key\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `Colon`,\n        \"data-zel\": \"builder\",\n        children: \":\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `Colon`,\n        \"data-zel\": \"builder\",\n        children: `{`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        className: `Inline-Button`,\n        src: crossIcon,\n        alt: \"Delete entry\",\n        onMouseDown: deleteEntry,\n        \"data-zel\": \"builder\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 5\n      }, this)]\n    }, key, true, {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 4\n    }, this)); // console.log(path)\n\n    setList(e.timeStamp);\n  };\n\n  const handleNestArray = e => {\n    let key = `key_${generateRandomString()}`;\n    let id = `id_${generateRandomString()}`;\n    path.push({\n      type: 'array',\n      key\n    });\n    let entry = {\n      id: id,\n      key: key,\n      type: 'array',\n      value: [],\n      path: JSON.parse(JSON.stringify(path))\n    };\n    prepObj.push(entry);\n    prepArray.push( /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `Data-Entry`,\n      \"data-zel\": \"builder\",\n      \"data-zid\": entry.id,\n      \"data-zkey\": entry.key,\n      onMouseDown: ev => startDrag(ev),\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: `Input-Field key`,\n        \"data-zcm\": 'key',\n        \"data-zel\": \"builder\",\n        onInput: ev => handleChange(ev, entry),\n        onMouseDown: ev => setEdit(ev, activeTool),\n        onBlur: ev => unsetEdit(ev),\n        style: {\n          color: '#ffd900'\n        },\n        children: entry.key\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `Colon`,\n        \"data-zel\": \"builder\",\n        children: \":\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `Colon`,\n        \"data-zel\": \"builder\",\n        children: `[`\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 423,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        className: `Inline-Button`,\n        src: crossIcon,\n        alt: \"Delete entry\",\n        onMouseDown: deleteEntry,\n        \"data-zel\": \"builder\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 424,\n        columnNumber: 5\n      }, this)]\n    }, key, true, {\n      fileName: _jsxFileName,\n      lineNumber: 420,\n      columnNumber: 4\n    }, this)); // console.log(prepObj)\n\n    setList(e.timeStamp);\n  };\n\n  const deleteEntry = event => {\n    let parent = event.currentTarget.parentElement;\n    prepObj.forEach((e, i) => {\n      if (e.id === parent.dataset.zid) {\n        console.log(e);\n\n        if (e.type === 'close') {\n          path.push({\n            type: prepObj[i].value\n          });\n        } else if (e.type !== 'pair') {\n          path.pop();\n        }\n\n        prepObj.splice(i, 1);\n        prepArray.splice(i, 1);\n      }\n    });\n    setList(event.timeStamp);\n  };\n\n  const closeNest = e => {\n    // console.log(path)\n    let nestType = {\n      type: 'close',\n      value: path[path.length - 1].type,\n      id: `${Date.now()}`\n    };\n    prepObj.push(nestType);\n    console.log(nestType);\n    prepArray.push( /*#__PURE__*/_jsxDEV(\"div\", {\n      onMouseDown: ev => startDrag(ev),\n      className: `Colon closing`,\n      \"data-zid\": nestType.id,\n      \"data-zel\": \"builder\",\n      style: {\n        paddingLeft: `${(path.length - 1) * .7}rem`\n      },\n      children: [')', /*#__PURE__*/_jsxDEV(\"img\", {\n        className: `Inline-Button`,\n        src: crossIcon,\n        alt: \"Delete entry\",\n        onMouseDown: deleteEntry,\n        \"data-zel\": \"builder\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 455,\n        columnNumber: 5\n      }, this)]\n    }, nestType.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 454,\n      columnNumber: 4\n    }, this));\n    path.pop();\n    setList(e.timeStamp);\n  };\n\n  const compileJSON = () => {\n    const json = {};\n    let shift = {};\n    let nest = json;\n    const builderPath = [];\n    Object.values(prepObj).forEach(e => {\n      // console.log(e)\n      if (e.type === 'close') {\n        shift = json;\n        builderPath.pop();\n        builderPath.forEach(e => {\n          shift = Array.isArray(shift) ? shift.find(f => Object.keys(f)[0] === e)[e] : shift[e];\n        });\n        nest = shift;\n      } else {\n        if (e.type === 'pair') {\n          if (Array.isArray(nest)) {\n            nest.push({\n              [e.key]: e.value\n            });\n          } else {\n            nest[e.key] = e.value;\n          }\n        } else {\n          if (Array.isArray(nest)) {\n            let sub = {\n              [e.key]: e.type === 'nest' ? {} : []\n            };\n            nest.push(sub);\n            nest = sub[e.key];\n          } else {\n            nest[e.key] = e.type === 'nest' ? {} : [];\n            nest = nest[e.key];\n          }\n\n          builderPath.push(e.key);\n        }\n      }\n    }); // console.log(JSON.stringify(json));\n\n    rawjson = JSON.stringify(json, null, 3); // element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\n    // element.setAttribute('download', filename);\n    // console.log(shift)\n    // console.log(nest)\n    // console.log(json)\n    // console.log(path)\n  };\n\n  const findMatch = () => {\n    console.log(prepObj);\n    prepObj.forEach(e => {\n      if (e.type === 'pair' && e.value) {\n        e.match = [];\n        Object.values(_evilcook.components.collection).forEach(c => {\n          let component = `${c.path}_${c.name}`;\n          let escapedString = e.value.replace(/(?=[-[\\]{}()*+?.,\\\\^$|#])/g, '\\\\');\n          let regex = new RegExp(`([\"'\\`{].*|[^>][\\\\s\\\\w]*|)(?:` + escapedString + `)(.*[\"'\\`}]|[\\\\s\\\\w]*[^<]|)`, 'gi');\n          let matches = c.rawComponent.match(regex); // escape RegEx special characters\n\n          c.rawComponent.replace(regex, '<span style={{ color: black, backgroundColor: white }}>' + e.value + '</span>'); // (?:[\"']|)(?:Boka Bord)((?!\\w).[\\s\\S])(.*\\s+[^\"']+)  -- selects reverse\n          // ^(?![\"'])(?![^[:alpha:]])(?:boka bord)(?=[^[:alpha:]]\\B)([\\s]*?[\"']|)   --- selects with letters in the beginning\n\n          matches && e.match.push({\n            component,\n            matches\n          });\n        });\n      }\n\n      Object.values(_evilcook.components.collection).forEach(c => {\n        let component = `${c.path}_${c.name}`;\n        let escapedString = e.value.replace(/(?=[-[\\]{}()*+?.,\\\\^$|#])/g, '\\\\');\n        console.log(escapedString);\n        let regex = new RegExp(`([\"'\\`{].*|[^>][\\\\s\\\\w]*|)(?:` + escapedString + `)(.*[\"'\\`}]|[\\\\s\\\\w]*[^<]|)`, 'gi'); // let matches = c.rawComponent.match(regex);\t// escape RegEx special characters\n        // console.log(c.rawComponent.replace(regex, '<span style={{ color: black, backgroundColor: white }}>' + e.value + '</span>'));\n\n        rawComponents.push( /*#__PURE__*/_jsxDEV(\"pre\", {\n          className: `Raw-Component`,\n          \"data-zel\": \"builder\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `Raw-Heading`,\n            onClick: openCode,\n            \"data-zel\": \"builder\",\n            children: /*#__PURE__*/_jsxDEV(\"h2\", {\n              \"data-zel\": \"builder\",\n              children: component\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 540,\n              columnNumber: 80\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 540,\n            columnNumber: 7\n          }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n            \"data-zel\": \"builder\",\n            children: c.rawComponent\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 541,\n            columnNumber: 7\n          }, this)]\n        }, Date.now(), true, {\n          fileName: _jsxFileName,\n          lineNumber: 539,\n          columnNumber: 6\n        }, this)); // console.log(c.rawComponent);\n      });\n    });\n  };\n\n  function openCode(e) {\n    if (e.currentTarget.parentElement.style.height === 'auto') {\n      e.currentTarget.parentElement.style.height = '';\n    } else {\n      e.currentTarget.parentElement.style.height = 'auto';\n    }\n  }\n\n  const handleToolbarSelection = (e, action) => {\n    action === 'json' && compileJSON();\n    action === 'dig' && findMatch();\n    action !== 'download' && setTool(action);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `JSON-Builder ${toggleMinimizeState}`,\n    \"data-zel\": \"builder\",\n    \"data-zmain\": \"builderContainer\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: `JSON-Builder-Header`,\n      onMouseDown: handleMouseDown,\n      \"data-zel\": \"builder\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `Builder-Minimize-Button`,\n        onClick: minimizeBuilder,\n        \"data-zel\": \"builder\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 570,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 569,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `Builder-Heading-Group`,\n      \"data-zel\": \"builder\",\n      children: /*#__PURE__*/_jsxDEV(\"h1\", {\n        className: `Builder-Heading`,\n        \"data-zel\": \"builder\",\n        children: \"Data Collection\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 573,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 572,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `Info-Row`,\n      \"data-zel\": \"builder\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: ev => handleToolbarSelection(ev, 'edit'),\n        className: activeTool === 'edit' ? `active` : '',\n        \"data-zel\": \"builder\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: editIcon,\n          alt: \"Edit Icon\",\n          \"data-zel\": \"builder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 577,\n          columnNumber: 137\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: ev => handleToolbarSelection(ev, 'sort'),\n        className: activeTool === 'sort' ? `active` : '',\n        \"data-zel\": \"builder\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: sortIcon,\n          alt: \"Sort Icon\",\n          \"data-zel\": \"builder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 137\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 578,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: ev => handleToolbarSelection(ev, 'json'),\n        className: activeTool === 'json' ? `active` : '',\n        \"data-zel\": \"builder\",\n        children: /*#__PURE__*/_jsxDEV(\"h2\", {\n          \"data-zel\": \"builder\",\n          children: \"JSON\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 579,\n          columnNumber: 137\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: ev => handleToolbarSelection(ev, 'dig'),\n        className: activeTool === 'dig' ? `active` : '',\n        \"data-zel\": \"builder\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: compileIcon,\n          alt: \"Compile Icon\",\n          \"data-zel\": \"builder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 135\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 580,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: ev => handleToolbarSelection(ev, 'download'),\n        \"data-zel\": \"builder\",\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: downloadIcon,\n          alt: \"Download Icon\",\n          \"data-zel\": \"builder\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 581,\n          columnNumber: 89\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 581,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `JSON-Container viewer ${activeTool === 'dig' ? `active` : ''}`,\n      \"data-zel\": \"builder\",\n      children: rawComponents\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `JSON-Container viewer ${activeTool === 'json' ? `active` : ''}`,\n      \"data-zel\": \"builder\",\n      children: /*#__PURE__*/_jsxDEV(\"pre\", {\n        \"data-zel\": \"builder\",\n        children: rawjson\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 590,\n        columnNumber: 5\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 589,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `JSON-Container ${activeTool === 'edit' ? `active` : ''}`,\n      \"data-zel\": \"builder\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        \"data-zel\": \"builder\",\n        children: prepArray\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 595,\n        columnNumber: 5\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `Controller-Buttons`,\n        \"data-zel\": \"builder\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleNest,\n          \"data-zel\": \"builder\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            \"data-zel\": \"builder\",\n            children: `{}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 599,\n            columnNumber: 56\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 599,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleNestArray,\n          \"data-zel\": \"builder\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            \"data-zel\": \"builder\",\n            children: `[]`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 600,\n            columnNumber: 61\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 6\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: closeNest,\n          className: !((_path = path[path.length - 1]) === null || _path === void 0 ? void 0 : _path.type) ? 'disabled' : '',\n          \"data-zel\": \"builder\",\n          children: /*#__PURE__*/_jsxDEV(\"h3\", {\n            \"data-zel\": \"builder\",\n            children: ((_path2 = path[path.length - 1]) === null || _path2 === void 0 ? void 0 : _path2.type) === 'nest' ? `<-{}` : ((_path3 = path[path.length - 1]) === null || _path3 === void 0 ? void 0 : _path3.type) === 'array' ? `<-[]` : `<-`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 601,\n            columnNumber: 114\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 601,\n          columnNumber: 6\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 598,\n        columnNumber: 5\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `JSON-Builder-Handle-Bottom stripes`,\n      onMouseDown: handleStartResize,\n      \"data-rh\": \"bottom\",\n      \"data-zel\": \"builder\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 604,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `JSON-Builder-Handle-Left stripes`,\n      onMouseDown: handleStartResize,\n      \"data-rh\": \"left\",\n      \"data-zel\": \"builder\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 605,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 568,\n    columnNumber: 3\n  }, this);\n};\n\n_s(JSONBuilder, \"hCvZn0z6EFZ0bjw870T0+zvKMRw=\");\n\n_c = JSONBuilder;\nexport default JSONBuilder;\n\nvar _c;\n\n$RefreshReg$(_c, \"JSONBuilder\");","map":{"version":3,"sources":["C:/webWork/htdocs/angryPXL/apps/datacollector/src/logic/jsonbuilder.jsx"],"names":["React","useState","useEffect","_zcmStart","_evilcook","builderHook","prepArray","prepObj","path","handleChange","event","obj","console","log","target","dataset","zcm","innerText","parent","findRealParent","zkey","setEdit","e","stopPropagation","setAttribute","unsetEdit","removeAttribute","viewport","height","window","innerHeight","width","innerWidth","resizeStartValues","x","y","startPos","dragOffset","hitBox","top","val","drop","hit","right","bottom","left","el","set","name","realParent","parentElement","generateRandomString","Math","random","toString","substring","builderDims","logTick","logTimer","setTimeout","rawjson","rawComponents","mouseMove","mouseUp","resizeMove","resizeEnd","JSONBuilder","toggleMinimizeState","setToggleMinimize","list","setList","activeTool","setTool","dragging","dragY","dragged","heroIndex","targetIndex","startDrag","screenY","style","pointerEvents","zIndex","userSelect","siblings","children","Object","values","forEach","s","addEventListener","dragEntry","c","i","id","zid","dropEntry","dragEntryOffset","preventDefault","transform","hero","uiHero","splice","timeStamp","removeEventListener","handleMouseMove","container","screenPos","getBoundingClientRect","screenX","handleMouseUp","handleMouseDown","handleResizeMove","handle","vals","handleResizeEnd","handleStartResize","rh","box","minimizeBuilder","dispatch","onclick","zel","selected","key","entry","type","value","innerHTML","replace","JSON","parse","stringify","push","ev","crossIcon","deleteEntry","handleNest","color","handleNestArray","currentTarget","pop","closeNest","nestType","length","Date","now","paddingLeft","compileJSON","json","shift","nest","builderPath","Array","isArray","find","f","keys","sub","findMatch","match","components","collection","component","escapedString","regex","RegExp","matches","rawComponent","openCode","handleToolbarSelection","action","editIcon","sortIcon","compileIcon","downloadIcon"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport './jsonbuilder.css';\r\nimport './syntaxhighlight';\r\nimport { _zcmStart, _evilcook } from './cat';\r\n\r\n// icons\r\nimport editIcon from './builder/edit.svg';\r\nimport sortIcon from './builder/sort.svg';\r\nimport downloadIcon from './builder/download.svg';\r\nimport compileIcon from './builder/compile.svg';\r\nimport crossIcon from './builder/circlecross.svg';\r\n\r\n\r\n\r\nexport const builderHook = {\r\n\r\n}\r\n\r\nconst prepArray = [];\r\nconst prepObj = [];\r\nvar path = [];\r\n\r\nconst handleChange = (event, obj) => {\r\n\tconsole.log(event.target.dataset.zcm)\r\n\tconsole.log(obj)\r\n\tobj[event.target.dataset.zcm] = event.target.innerText;\r\n\tlet parent = findRealParent(event.target, 'zkey');\r\n\tparent.dataset.zkey = event.target.innerText;\r\n}\r\n\r\n\r\nconst setEdit = (e) => {\r\n\te.stopPropagation();\r\n\t// if ( activeTool === 'edit' ) {\r\n\t\te.target.setAttribute('contenteditable', '');\r\n\r\n\t// } else if ( activeTool === 'sort' ) {\r\n\t// \te.target.draggable = true;\r\n\t\t\r\n\t// \tconsole.log(e.target)\r\n\t\t\r\n\t// } else if ( activeTool === 'json' ) {\r\n\r\n\t// } else if ( activeTool === 'compile' ) {\r\n\r\n\t// }\r\n\t\r\n}\r\nconst unsetEdit = (e) => {\r\n\te.target.removeAttribute('contenteditable');\r\n}\r\n\r\nvar viewport = {\r\n\theight: window.innerHeight,\r\n\twidth: window.innerWidth,\r\n}\r\n\r\nvar resizeStartValues = { x: 0, y: 0 }\r\nvar startPos = { x: 0, y: 0 }\r\nvar dragOffset = { x: 0, y: 0 }\r\nvar hitBox = {\r\n\ttop: {\r\n\t\tval: 0,\r\n\t\tdrop: 0,\r\n\t\thit: false,\r\n\t},\r\n\tright: {\r\n\t\tval: 0,\r\n\t\tdrop: 0,\r\n\t\thit: false,\r\n\t},\r\n\tbottom: {\r\n\t\tval: 0,\r\n\t\tdrop: 0,\r\n\t\thit: false,\r\n\t},\r\n\tleft: {\r\n\t\tval: 0,\r\n\t\tdrop: 0,\r\n\t\thit: false,\r\n\t}\r\n}\r\n\r\nconst findRealParent = (el, set, name='any') => {\r\n\tlet realParent = el;\r\n\tif ( name === 'any' ) {\r\n\t\twhile ( !realParent.dataset[set] ) {\r\n\t\t\trealParent = realParent.parentElement;\r\n\t\t}\r\n\t} else if ( name !== 'any' ) {\r\n\t\twhile ( realParent.dataset[set] !== name ) {\r\n\t\t\trealParent = realParent.parentElement;\r\n\t\t}\r\n\t}\r\n\treturn realParent;\r\n}\r\n\r\nconst generateRandomString = () => {\r\n\treturn Math.random().toString(36).substring(2, 15);\r\n\t// + Math.random().toString(36).substring(2, 15)\r\n}\r\n\r\nconst builderDims = {\r\n\theight: 0,\r\n\twidth: 0,\r\n}\r\n\r\nlet logTick = true;\r\nconst logTimer = () => {\r\n\tlogTick = false;\r\n\tsetTimeout(()=>{\r\n\t\tlogTick = true;\r\n\t}, 200);\r\n}\r\n\r\n// init copycat\r\n_zcmStart();\r\n\r\nlet rawjson = '';\r\nlet rawComponents = [];\r\nvar mouseMove, mouseUp, resizeMove, resizeEnd;\r\nconst JSONBuilder = () => {\r\n\tconst [ toggleMinimizeState, setToggleMinimize ] = useState('open');\r\n\tconst [ list, setList ] = useState(null);\r\n\tconst [ activeTool, setTool ] = useState('edit');\r\n\r\n\r\nlet dragging = false;\r\nlet dragY = 0;\r\nlet dragged;\r\nlet heroIndex, targetIndex;\r\nfunction startDrag(e) {\r\n\tdragY = e.screenY;\r\n\tdragged = e.target;\r\n\tdragged.style.pointerEvents = 'none';\r\n\tdragged.style.zIndex = '10';\r\n\tlet parent = e.target.parentElement;\r\n\tparent.style.userSelect = 'none';\r\n\tlet siblings = parent.children;\r\n\tObject.values(siblings).forEach( s => {\r\n\t\ts.addEventListener('mousemove', dragEntry);\r\n\t});\r\n\tprepObj.forEach( (c,i) => {\r\n\t\tif ( c.id === e.target.dataset.zid ) {\r\n\t\t\theroIndex = i;\r\n\t\t\treturn;\r\n\t\t}\r\n\t});\r\n\twindow.addEventListener('mouseup', dropEntry);\r\n}\r\n\r\nlet dragEntryOffset;\r\nfunction dragEntry(e) {\r\n\te.stopPropagation();\r\n\te.preventDefault();\r\n\tdragging = true;\r\n\tif ( dragged ) {\r\n\t\tdragEntryOffset = e.screenY - dragY;\r\n\t\tdragged.style.transform = `translate3d(0,${ dragEntryOffset }px,0)`;\r\n\t}\r\n\t\r\n\t\r\n\tprepObj.forEach( (c,i) => {\r\n\t\tif ( c.id === e.target.dataset.zid ) {\r\n\t\t\ttargetIndex = i;\r\n\t\t\t// console.log(c.id)\r\n\t\t\treturn;\r\n\t\t}\r\n\t});\t\r\n}\r\n\r\n\r\nfunction dropEntry(e) {\r\n\te.stopPropagation();\r\n\te.preventDefault();\r\n\tdragged && dragged.removeAttribute('style');\r\n\tdragEntryOffset = 0;\r\n\tdragged = null;\r\n\tlet parent = e.target.parentElement;\r\n\r\n\tif ( parent ) {\r\n\t\tlet siblings = parent.children;\r\n\r\n\t\r\n\t\tparent.style.userSelect = '';\r\n\t\t\r\n\t\tif ( targetIndex >= 0 && dragging === true ) {\r\n\t\t\tlet hero = prepObj[heroIndex];\r\n\t\t\tlet uiHero = prepArray[heroIndex];\r\n\t\t\tprepObj.splice(heroIndex, 1);\r\n\t\t\tprepObj.splice(targetIndex, 0, hero);\r\n\t\t\tprepArray.splice(heroIndex, 1);\r\n\t\t\tprepArray.splice(targetIndex, 0, uiHero);\r\n\r\n\r\n\t\t\tsetList(e.timeStamp);\r\n\t\t}\r\n\t\tdragging = false;\r\n\t\twindow.removeEventListener('mouseup', dropEntry);\r\n\t\tObject.values(siblings).forEach( s => {\r\n\t\t\ts.removeEventListener('mousemove', dragEntry);\r\n\t\t});\r\n\t}\r\n\r\n// }\r\n}\r\n\r\n\r\n\r\n\tfunction handleMouseMove(e, el, container) {\r\n\t\te.stopPropagation();\r\n    e.preventDefault();\r\n\t\tlet screenPos = container.getBoundingClientRect();\r\n\t\thitBox.top.val = screenPos.top;\r\n\t\thitBox.right.val = screenPos.right;\r\n\t\thitBox.bottom.val = screenPos.bottom;\r\n\t\thitBox.left.val = screenPos.left;\r\n\r\n\t\t\r\n\t\t// hit detection top & bottom\r\n\t\tif ( hitBox.top.val >= 0 && !hitBox.top.hit && hitBox.bottom.val <= viewport.height && !hitBox.bottom.hit ) {\r\n\t\t\tdragOffset.y = e.screenY - startPos.y;\r\n\t\t} else if ( hitBox.top.val <= 0 && !hitBox.top.hit ) {\r\n\t\t\t!hitBox.bottom.hit && (hitBox.top.hit = true);\r\n\t\t\thitBox.top.drop = e.screenY;\r\n\t\t} else if ( e.screenY > hitBox.top.drop && hitBox.top.hit ) {\r\n\t\t\thitBox.top.hit = false;\r\n\t\t\t!hitBox.bottom.hit && (dragOffset.y += 1);\r\n\t\t} else if ( hitBox.bottom.val >= viewport.height && !hitBox.bottom.hit ) {\r\n\t\t\t!hitBox.top.hit && (hitBox.bottom.hit = true);\r\n\t\t\thitBox.bottom.drop = e.screenY;\r\n\t\t} else if ( e.screenY < hitBox.bottom.drop && hitBox.bottom.hit ) {\r\n\t\t\thitBox.bottom.hit = false;\r\n\t\t\t!hitBox.top.hit && (dragOffset.y -= 1);\r\n\t\t}\r\n\t\t\r\n\t\t// hit detection left & right\r\n\t\tif ( hitBox.left.val >= 0 && !hitBox.left.hit && hitBox.right.val <= viewport.width && !hitBox.right.hit ) {\r\n\t\t\tdragOffset.x = e.screenX - startPos.x;\r\n\t\t} else if ( hitBox.left.val <= 0 && !hitBox.left.hit ) {\r\n\t\t\t!hitBox.right.hit && (hitBox.left.hit = true);\r\n\t\t\thitBox.left.drop = e.screenX;\r\n\t\t} else if ( e.screenX > hitBox.left.drop && hitBox.left.hit ) {\r\n\t\t\thitBox.left.hit = false;\r\n\t\t\t!hitBox.right.hit && (dragOffset.x += 1);\r\n\t\t} else if ( hitBox.right.val >= 0 && !hitBox.right.hit ) {\r\n\t\t\t!hitBox.left.hit && (hitBox.right.hit = true);\r\n\t\t\thitBox.right.drop = e.screenX;\r\n\t\t} else if ( e.screenX < hitBox.right.drop && hitBox.right.hit ) {\r\n\t\t\thitBox.right.hit = false;\r\n\t\t\t!hitBox.left.hit && (dragOffset.x -= 1);\r\n\t\t}\r\n\r\n\r\n\r\n\t\t// logTick && console.log(`screeX:  ${e.screenX}\\n`, `dragOffsetX:  ${dragOffset.x}`);\r\n\t\t// logTick && console.log(`hitRight:  ${hitBox.right.hit}\\n`, `hitLeft:  ${hitBox.left.hit}`);\r\n\t\t// logTick && console.log(`leftDrop:  ${hitBox.left.drop}\\n`, `leftVal:  ${hitBox.left.val}`);\r\n\t\t// logTick && console.log(`rightDrop:  ${hitBox.right.drop}\\n`, `rightVal:  ${hitBox.right.val}`, `vpHeight:  ${viewport.width}`);\r\n\t\t//____________________________________________________________________________________________________________\r\n\t\t// logTick && console.log(`screeY:  ${e.screenY}\\n`, `dragOffsetY:  ${dragOffset.y}`);\r\n\t\t// logTick && console.log(`hitBottom:  ${hitBox.bottom.hit}\\n`, `hitTop:  ${hitBox.top.hit}`);\r\n\t\t// logTick && console.log(`topDrop:  ${hitBox.top.drop}\\n`, `topVal:  ${hitBox.top.val}`);\r\n\t\t// logTick && console.log(`bottomDrop:  ${hitBox.bottom.drop}\\n`, `bottomVal:  ${hitBox.bottom.val}`, `vpHeight:  ${viewport.height}`);\r\n\t\t\r\n\r\n\r\n\r\n\t\t// logTick && console.log(e.screenX, hitBox.right.drop, dragOffset.x, hitBox.right.val, viewport.width, hitBox.right.hit);\r\n\t\t\r\n    \r\n\t\tcontainer.style.transform = `translate3d( ${ dragOffset.x }px, ${ dragOffset.y }px,0 )`;\r\n\t\tlogTick && logTimer();\r\n  }\r\n\r\n  function handleMouseUp(e) {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n\t\twindow.removeEventListener( 'mousemove', mouseMove );\r\n\t\twindow.removeEventListener( 'mouseup', mouseUp );\r\n\t\thitBox.top.drop = 0;\r\n\t\thitBox.right.drop = viewport.width;\r\n\t\thitBox.bottom.drop = viewport.height;\r\n\t\thitBox.left.drop = 0;\r\n  }\r\n\r\n  function handleMouseDown(e) {\r\n\t\tlet container = findRealParent(e.target, 'zmain', 'builderContainer');\r\n\t\te.stopPropagation();\r\n    e.preventDefault();\r\n\t\tmouseMove = (event) => handleMouseMove(event, e, container);\r\n\t\tmouseUp = (event) => handleMouseUp(event, e);\r\n\t\twindow.addEventListener( 'mousemove', mouseMove );\r\n\t\twindow.addEventListener( 'mouseup', mouseUp );\r\n\t\tstartPos = {\r\n\t\t\tx: e.screenX - dragOffset.x,\r\n\t\t\ty: e.screenY - dragOffset.y,\r\n\t\t}\r\n  }\r\n\r\n\tfunction handleResizeMove(e, el, container, handle, vals) {\r\n\t\tif ( handle === 'bottom' ) {\r\n\t\t\tcontainer.style.height = `${resizeStartValues.height + e.screenY - resizeStartValues.y}px`;\r\n\t\t} else {\r\n\t\t\tcontainer.style.width = `${resizeStartValues.width + resizeStartValues.x - e.screenX}px`;\r\n\t\t}\r\n\r\n\t\t// logTick && logTimer();\r\n\t}\r\n\r\n\tfunction handleResizeEnd(e) {\r\n\t\te.stopPropagation();\r\n    e.preventDefault();\r\n\t\twindow.removeEventListener( 'mousemove', resizeMove );\r\n\t\twindow.removeEventListener( 'mouseup', resizeEnd );\r\n\t}\r\n\r\n\tfunction handleStartResize(e) {\r\n\t\tlet container = findRealParent(e.target, 'zmain', 'builderContainer');\r\n\t\t\r\n\t\tlet handle = e.target.dataset.rh;\r\n\t\tlet box = container.getBoundingClientRect();\r\n\t\tresizeStartValues = {\r\n\t\t\tx: e.screenX,\r\n\t\t\ty: e.screenY,\r\n\t\t\theight: box.height,\r\n\t\t\twidth: box.width,\r\n\t\t\tleft: box.left,\r\n\t\t\tright: box.right,\r\n\t\t}\r\n\t\te.stopPropagation();\r\n    e.preventDefault();\r\n\t\tresizeMove = (event) => handleResizeMove(event, e, container, handle);\r\n\t\tresizeEnd = (event) => handleResizeEnd(event, e);\r\n\t\twindow.addEventListener( 'mousemove', resizeMove );\r\n\t\twindow.addEventListener( 'mouseup', resizeEnd );\r\n\t\t\r\n\t}\r\n\r\n\tfunction minimizeBuilder(e) {\r\n\t\tlet container = findRealParent(e.target, 'zmain', 'builderContainer');\r\n\r\n\t\tif ( toggleMinimizeState === 'open' ) {\r\n\t\t\tbuilderDims.height = container.style.height;\r\n\t\t\tbuilderDims.width = container.style.width;\r\n\t\t\tcontainer.style.height = '';\r\n\t\t\tcontainer.style.width = '';\r\n\t\t\thitBox.top.drop = 0;\r\n\t\t\thitBox.right.drop = viewport.width;\r\n\t\t\thitBox.bottom.drop = viewport.height;\r\n\t\t\thitBox.left.drop = 0;\r\n\t\t\thitBox.top.hit = false;\r\n\t\t\thitBox.right.hit = false;\r\n\t\t\thitBox.bottom.hit = false;\r\n\t\t\thitBox.left.hit = false;\r\n\t\t\tsetToggleMinimize('minimized');\r\n\t\t} else {\r\n\t\t\tcontainer.style.height = builderDims.height;\r\n\t\t\tcontainer.style.width = builderDims.width;\r\n\t\t\tsetToggleMinimize('open');\r\n\t\t}\r\n\t}\r\n\r\n\tuseEffect(()=>{\r\n\t\tbuilderHook.dispatch = setList;\r\n\t\twindow.onclick = (e) => {\r\n\t\t\te.stopPropagation();\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tif ( e.target.dataset.zel !== 'builder' && !e.target.dataset.selected ) {\r\n\t\t\t\tlet key = `key_${generateRandomString()}`;\r\n\t\t\t\tlet id = `id_${generateRandomString()}`;\r\n\t\t\t\te.target.setAttribute('data-selected', key);\r\n\r\n\t\t\t\tlet entry = { id: id, key: key, type: 'pair', value: e.target.innerHTML.replace(/<span[\\s\\S]*?\\b<\\/span>/g, ''), path: JSON.parse(JSON.stringify(path)) }\r\n\t\t\t\tprepObj.push(entry);\r\n\t\t\t\t\r\n\t\t\t\tprepArray.push(\r\n\t\t\t\t\t<div key={ key } className={ `Data-Entry` } data-zel=\"builder\" data-zid={ entry.id } data-zkey={ entry.key } onMouseDown={ (ev)=>startDrag(ev) }>\r\n\t\t\t\t\t\t<h3 className={ `Input-Field key` } data-zcm={ 'key' } data-zel=\"builder\" onInput={ (ev)=>handleChange(ev, entry) } onMouseDown={ (ev)=>setEdit(ev, activeTool) } onBlur={ (ev)=>unsetEdit(ev) }>{ entry.key }</h3>\r\n\t\t\t\t\t\t<div className={ `Colon` } data-zel=\"builder\">:</div>\r\n\t\t\t\t\t\t<h3 className={ `Input-Field value` } data-zcm={ 'value' } data-zel=\"builder\" onInput={ (ev)=>handleChange(ev, entry) } onMouseDown={ (ev)=>setEdit(ev, activeTool) } onBlur={ (ev)=>unsetEdit(ev) }>{ entry.value }</h3>\r\n\t\t\t\t\t\t<img className={ `Inline-Button` } src={ crossIcon } alt=\"Delete entry\" onMouseDown={ deleteEntry } data-zel=\"builder\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t\tsetList(e.timeStamp);\r\n\t\t\t}\r\n\t\t}\r\n\t}, []);\r\n\r\n\tconst handleNest = (e) => {\r\n\t\tlet key = `key_${generateRandomString()}`;\r\n\t\tlet id = `id_${generateRandomString()}`;\r\n\r\n\t\tpath.push({ type: 'nest', key });\r\n\t\tlet entry = { id: id, key: key, type: 'nest', value: {}, path: JSON.parse(JSON.stringify(path)) }\r\n\t\tprepObj.push(entry);\r\n\r\n\t\tprepArray.push(\r\n\t\t\t<div key={ key } className={ `Data-Entry` } data-zel=\"builder\" data-zid={ entry.id } data-zkey={ entry.key } onMouseDown={ (ev)=>startDrag(ev) }>\r\n\t\t\t\t<h3 className={ `Input-Field key` } data-zcm={ 'key' } data-zel=\"builder\" onInput={ (ev)=>handleChange(ev, entry) } onMouseDown={ (ev)=>setEdit(ev, activeTool) } onBlur={ (ev)=>unsetEdit(ev) } style={{ color: '#f751b1' }}>{ entry.key }</h3>\r\n\t\t\t\t<div className={ `Colon` } data-zel=\"builder\">:</div>\r\n\t\t\t\t<div className={ `Colon` } data-zel=\"builder\">{ `{` }</div>\r\n\t\t\t\t<img className={ `Inline-Button` } src={ crossIcon } alt=\"Delete entry\" onMouseDown={ deleteEntry } data-zel=\"builder\" />\r\n\t\t\t</div>\r\n\t\t);\r\n\t\t\t// console.log(path)\r\n\t\tsetList(e.timeStamp);\r\n\t}\r\n\r\n\tconst handleNestArray = (e) => {\r\n\t\tlet key = `key_${generateRandomString()}`;\r\n\t\tlet id = `id_${generateRandomString()}`;\r\n\r\n\t\tpath.push({ type: 'array', key });\r\n\t\tlet entry = { id: id, key: key, type: 'array', value: [], path: JSON.parse(JSON.stringify(path)) }\r\n\t\tprepObj.push(entry);\r\n\r\n\t\tprepArray.push(\r\n\t\t\t<div key={ key } className={ `Data-Entry` } data-zel=\"builder\" data-zid={ entry.id } data-zkey={ entry.key } onMouseDown={ (ev)=>startDrag(ev) }>\r\n\t\t\t\t<h3 className={ `Input-Field key` } data-zcm={ 'key' } data-zel=\"builder\" onInput={ (ev)=>handleChange(ev, entry) } onMouseDown={ (ev)=>setEdit(ev, activeTool) } onBlur={ (ev)=>unsetEdit(ev) } style={{ color: '#ffd900' }}>{ entry.key }</h3>\r\n\t\t\t\t<div className={ `Colon` } data-zel=\"builder\">:</div>\r\n\t\t\t\t<div className={ `Colon` } data-zel=\"builder\">{ `[` }</div>\r\n\t\t\t\t<img className={ `Inline-Button` } src={ crossIcon } alt=\"Delete entry\" onMouseDown={ deleteEntry } data-zel=\"builder\" />\r\n\t\t\t</div>\r\n\t\t);\r\n\t\t\t// console.log(prepObj)\r\n\t\tsetList(e.timeStamp);\r\n\t}\r\n\r\n\tconst deleteEntry = event => {\r\n\t\tlet parent = event.currentTarget.parentElement;\r\n\t\tprepObj.forEach((e, i) => {\r\n\t\t\tif ( e.id === parent.dataset.zid ) {\r\n\t\t\t\tconsole.log(e)\r\n\t\t\t\tif ( e.type === 'close' ) {\r\n\t\t\t\t\tpath.push({ type: prepObj[i].value });\r\n\t\t\t\t} else if ( e.type !== 'pair' ) {\r\n\t\t\t\t\tpath.pop();\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tprepObj.splice(i, 1);\r\n\t\t\t\tprepArray.splice(i, 1);\r\n\t\t\t}\r\n\t\t});\r\n\t\tsetList(event.timeStamp);\r\n\t}\r\n\tconst closeNest = (e) => {\r\n\t\t// console.log(path)\r\n\t\tlet nestType = { type: 'close', value: path[path.length-1].type, id: `${ Date.now() }` };\r\n\t\tprepObj.push(nestType);\r\n\t\tconsole.log(nestType)\r\n\t\tprepArray.push(\r\n\t\t\t<div key={ nestType.id } onMouseDown={ (ev)=>startDrag(ev) } className={ `Colon closing` }  data-zid={ nestType.id } data-zel=\"builder\" style={{ paddingLeft: `${ (path.length-1) * .7 }rem` }}>{ ')' }\r\n\t\t\t\t<img className={ `Inline-Button` } src={ crossIcon } alt=\"Delete entry\" onMouseDown={ deleteEntry } data-zel=\"builder\" />\r\n\t\t\t</div>\r\n\t\t);\r\n\t\tpath.pop();\r\n\r\n\t\tsetList(e.timeStamp);\r\n\t}\r\n\r\n\r\n \r\n\tconst compileJSON = () => {\r\n\t\tconst json = {};\r\n\t\tlet shift = {};\r\n\t\tlet nest = json;\r\n\t\tconst builderPath = [];\r\n\t\tObject.values(prepObj).forEach((e) => {\r\n\t\t\t// console.log(e)\r\n\t\t\tif ( e.type === 'close' ) {\r\n\t\t\t\tshift = json;\r\n\t\t\t\tbuilderPath.pop();\r\n\t\t\t\tbuilderPath.forEach(e=>{\r\n\t\t\t\t\tshift = Array.isArray(shift) ? shift.find(f=> Object.keys(f)[0] === e)[e] : shift[e];\r\n\t\t\t\t})\r\n\t\t\t\tnest = shift;\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\tif ( e.type === 'pair' ) {\r\n\t\t\t\t\tif ( Array.isArray(nest) ) {\r\n\t\t\t\t\t\tnest.push({[e.key]: e.value});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnest[e.key] = e.value;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ( Array.isArray(nest) ) {\r\n\t\t\t\t\t\tlet sub = {[e.key]: e.type === 'nest' ? {} : []};\r\n\t\t\t\t\t\tnest.push(sub);\r\n\t\t\t\t\t\tnest = sub[e.key];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnest[e.key] = e.type === 'nest' ? {} : [];\r\n\t\t\t\t\t\tnest = nest[e.key];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbuilderPath.push(e.key);\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t})\r\n\t\t// console.log(JSON.stringify(json));\r\n\t\trawjson = JSON.stringify(json, null, 3);\r\n\t\t\r\n\t\t// element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\r\n  \t// element.setAttribute('download', filename);\r\n\t\t// console.log(shift)\r\n\t\t// console.log(nest)\r\n\t\t// console.log(json)\r\n\t\t// console.log(path)\r\n\t}\r\n\r\n\tconst findMatch = () => {\r\n\t\tconsole.log(prepObj)\r\n\t\tprepObj.forEach(e => {\r\n\t\t\tif ( e.type === 'pair' && e.value ) {\r\n\t\t\t\te.match = [];\r\n\t\t\t\tObject.values(_evilcook.components.collection).forEach(c => {\r\n\t\t\t\t\tlet component = `${ c.path }_${ c.name }`;\r\n\t\t\t\t\tlet escapedString = e.value.replace(/(?=[-[\\]{}()*+?.,\\\\^$|#])/g, '\\\\');\r\n\t\t\t\t\t\r\n\t\t\t\t\tlet regex = new RegExp(`([\"'\\`{].*|[^>][\\\\s\\\\w]*|)(?:` + escapedString + `)(.*[\"'\\`}]|[\\\\s\\\\w]*[^<]|)`, 'gi')\r\n\t\t\t\t\tlet matches = c.rawComponent.match(regex);\t// escape RegEx special characters\r\n\t\t\t\t\tc.rawComponent.replace(regex, '<span style={{ color: black, backgroundColor: white }}>' + e.value + '</span>');\r\n\t\t\t\t\t// (?:[\"']|)(?:Boka Bord)((?!\\w).[\\s\\S])(.*\\s+[^\"']+)  -- selects reverse\r\n\t\t\t\t\t// ^(?![\"'])(?![^[:alpha:]])(?:boka bord)(?=[^[:alpha:]]\\B)([\\s]*?[\"']|)   --- selects with letters in the beginning\r\n\t\t\t\t\tmatches && e.match.push({ component, matches })\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t\tObject.values(_evilcook.components.collection).forEach(c => {\r\n\t\t\t\tlet component = `${ c.path }_${ c.name }`;\r\n\t\t\t\tlet escapedString = e.value.replace(/(?=[-[\\]{}()*+?.,\\\\^$|#])/g, '\\\\');\r\n\t\t\t\t\tconsole.log(escapedString)\r\n\t\t\t\t\tlet regex = new RegExp(`([\"'\\`{].*|[^>][\\\\s\\\\w]*|)(?:` + escapedString + `)(.*[\"'\\`}]|[\\\\s\\\\w]*[^<]|)`, 'gi')\r\n\t\t\t\t\t// let matches = c.rawComponent.match(regex);\t// escape RegEx special characters\r\n\t\t\t\t\t// console.log(c.rawComponent.replace(regex, '<span style={{ color: black, backgroundColor: white }}>' + e.value + '</span>'));\r\n\t\t\t\trawComponents.push(\r\n\t\r\n\t\t\t\t\t<pre key={ Date.now() } className={ `Raw-Component` } data-zel=\"builder\">\r\n\t\t\t\t\t\t<div className={ `Raw-Heading` } onClick={ openCode } data-zel=\"builder\"><h2 data-zel=\"builder\">{ component }</h2></div>\r\n\t\t\t\t\t\t<h3 data-zel=\"builder\">{ c.rawComponent }</h3>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t</pre>\r\n\t\t\t\t);\r\n\t\t\t\t// console.log(c.rawComponent);\r\n\t\t\t});\r\n\t\t});\r\n\t\t\r\n\t}\r\n\r\n\tfunction openCode(e) {\r\n\t\tif ( \te.currentTarget.parentElement.style.height === 'auto' ) {\r\n\t\t\te.currentTarget.parentElement.style.height = '';\r\n\t\t} else {\r\n\t\t\te.currentTarget.parentElement.style.height = 'auto';\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\tconst handleToolbarSelection = (e, action) => {\r\n\r\n\t\taction === 'json' && compileJSON();\r\n\t\taction === 'dig' && findMatch();\r\n\t\taction !== 'download' && setTool(action);\r\n\t}\r\n\r\n\treturn(\r\n\t\t<div className={ `JSON-Builder ${ toggleMinimizeState }` } data-zel=\"builder\" data-zmain=\"builderContainer\">\r\n\t\t\t<div className={ `JSON-Builder-Header` } onMouseDown={ handleMouseDown } data-zel=\"builder\">\r\n\t\t\t\t<button className={ `Builder-Minimize-Button` } onClick={ minimizeBuilder } data-zel=\"builder\"></button>\r\n\t\t\t</div>\r\n\t\t\t<div className={ `Builder-Heading-Group` } data-zel=\"builder\">\r\n\t\t\t\t<h1 className={ `Builder-Heading` } data-zel=\"builder\">Data Collection</h1>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t<div className={ `Info-Row` } data-zel=\"builder\">\r\n\t\t\t\t<button onClick={ (ev)=>handleToolbarSelection(ev, 'edit') } className={ activeTool === 'edit' ? `active` : '' } data-zel=\"builder\"><img src={ editIcon } alt=\"Edit Icon\" data-zel=\"builder\"/></button>\r\n\t\t\t\t<button onClick={ (ev)=>handleToolbarSelection(ev, 'sort') } className={ activeTool === 'sort' ? `active` : '' } data-zel=\"builder\"><img src={ sortIcon } alt=\"Sort Icon\" data-zel=\"builder\"/></button>\r\n\t\t\t\t<button onClick={ (ev)=>handleToolbarSelection(ev, 'json') } className={ activeTool === 'json' ? `active` : '' } data-zel=\"builder\"><h2 data-zel=\"builder\">JSON</h2></button>\r\n\t\t\t\t<button onClick={ (ev)=>handleToolbarSelection(ev, 'dig') } className={ activeTool === 'dig' ? `active` : '' } data-zel=\"builder\"><img src={ compileIcon } alt=\"Compile Icon\" data-zel=\"builder\"/></button>\r\n\t\t\t\t<button onClick={ (ev)=>handleToolbarSelection(ev, 'download') } data-zel=\"builder\"><img src={ downloadIcon } alt=\"Download Icon\" data-zel=\"builder\"/></button>\r\n\t\t\t\t\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* <div className={ `JSON-Builder-Handle-Right` } onMouseDown={ handleStartResize } data-rh=\"right\"></div> */}\r\n\t\t\t<div className={ `JSON-Container viewer ${ activeTool === 'dig' ? `active` : '' }` } data-zel=\"builder\">\r\n\t\t\t\t\t{ rawComponents }\r\n\t\t\t</div>\r\n\t\t\t<div className={ `JSON-Container viewer ${ activeTool === 'json' ? `active` : '' }` } data-zel=\"builder\">\r\n\t\t\t\t<pre data-zel=\"builder\">\r\n\t\t\t\t\t{ rawjson }\r\n\t\t\t\t</pre>\r\n\t\t\t</div>\r\n\t\t\t<div className={ `JSON-Container ${ activeTool === 'edit' ? `active` : '' }` } data-zel=\"builder\">\r\n\t\t\t\t<div data-zel=\"builder\">\r\n\t\t\t\t{ prepArray }\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className={ `Controller-Buttons` } data-zel=\"builder\">\r\n\t\t\t\t\t<button onClick={ handleNest } data-zel=\"builder\"><h3 data-zel=\"builder\">{ `{}` }</h3></button>\r\n\t\t\t\t\t<button onClick={ handleNestArray } data-zel=\"builder\"><h3 data-zel=\"builder\">{ `[]` }</h3></button>\r\n\t\t\t\t\t<button onClick={ closeNest } className={ !path[path.length-1]?.type ? 'disabled' : '' } data-zel=\"builder\"><h3 data-zel=\"builder\">{ path[path.length-1]?.type === 'nest' ? `<-{}` : path[path.length-1]?.type === 'array' ? `<-[]` : `<-` }</h3></button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div className={ `JSON-Builder-Handle-Bottom stripes` } onMouseDown={ handleStartResize } data-rh=\"bottom\" data-zel=\"builder\"></div>\r\n\t\t\t<div className={ `JSON-Builder-Handle-Left stripes` } onMouseDown={ handleStartResize } data-rh=\"left\" data-zel=\"builder\"></div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default JSONBuilder;"]},"metadata":{},"sourceType":"module"}